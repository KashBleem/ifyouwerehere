<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>If I Had You Hereâ€¦</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #fff0f5;
      color: #333;
      text-align: center;
      padding: 3rem 1rem;
      transition: background-color 0.5s ease;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    h1 {
      font-size: 2.5em;
      margin-bottom: 1rem;
      transition: color 0.3s ease;
    }
    .subtitle {
      font-size: 1.2em;
      margin-bottom: 2rem;
      color: #777;
    }
    #message {
      font-size: 1.5em;
      margin: 2rem auto;
      padding: 1.5rem;
      max-width: 600px;
      background: #ffe6eb;
      border-radius: 20px;
      min-height: 80px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .button-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }
    .button {
      background: #ff4d6d;
      color: white;
      padding: 1rem 2rem;
      border: none;
      border-radius: 30px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .button:hover {
      background: #e0435f;
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .button:active {
      transform: translateY(1px);
    }
    .safe {
      background: #ffd166;
      color: #333;
    }
    .safe:hover {
      background: #fcbf49;
    }
    .romantic {
      background: #c38efa;
      color: white;
    }
    .romantic:hover {
      background: #a66df7;
    }
    .copy {
      background: #7ac7ff;
      color: white;
      font-size: 0.9rem;
      padding: 0.8rem 1.5rem;
    }
    .copy:hover {
      background: #59b6ff;
    }
    .favorite {
      background: #ff8c9e;
      color: white;
      font-size: 0.9rem;
      padding: 0.8rem 1.5rem;
    }
    .favorite:hover {
      background: #ff6a82;
    }
    .favorites-panel {
      margin-top: 2rem;
      background: rgba(255, 255, 255, 0.7);
      padding: 1rem;
      border-radius: 10px;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease, padding 0.5s ease;
    }
    .favorites-panel.active {
      max-height: 300px;
      padding: 1rem;
      overflow-y: auto;
    }
    .favorites-list {
      list-style: none;
      padding: 0;
      text-align: left;
    }
    .favorites-list li {
      padding: 0.5rem;
      margin: 0.5rem 0;
      background: #ffe6eb;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
    }
    .favorites-list button {
      background: #ff4d6d;
      color: white;
      border: none;
      border-radius: 50%;
      width: 25px;
      height: 25px;
      cursor: pointer;
      font-size: 0.8rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .theme-toggle {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    .theme-toggle:hover {
      transform: rotate(180deg);
    }
    .dark-mode {
      background: #2a2a2a;
      color: #f0f0f0;
    }
    .dark-mode #message {
      background: #3d3d3d;
      color: #f0f0f0;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    .dark-mode .favorites-panel {
      background: rgba(50, 50, 50, 0.7);
    }
    .dark-mode .favorites-list li {
      background: #3d3d3d;
      color: #f0f0f0;
    }
    .indicator {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 5px;
    }
    .spicy-indicator {
      background-color: #ff4d6d;
    }
    .soft-indicator {
      background-color: #ffd166;
    }
    .romantic-indicator {
      background-color: #c38efa;
    }
    .message-fade {
      animation: fadeIn 0.5s;
    }
    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(-10px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    .footer {
      margin-top: 3rem;
      font-size: 0.8rem;
      color: #777;
    }
    .privacy-note {
      font-size: 0.7rem;
      opacity: 0.7;
      margin-top: 0.5rem;
    }
    .export-import {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1rem;
    }
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: white;
      padding: 10px 20px;
      border-radius: 20px;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 1000;
    }
    #importInput {
      display: none;
    }
    #storageInfo {
      font-size: 0.8rem;
      margin-top: 0.5rem;
      color: #777;
    }
    @media (max-width: 600px) {
      .button-container {
        flex-direction: column;
        align-items: center;
      }
      .button {
        width: 80%;
      }
    }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ™</button>
  <div class="container">
    <h1>If I Had You Hereâ€¦</h1>
    <p class="subtitle">What would happen next?</p>
    <div id="message">Click a button to fantasize ğŸ”¥</div>
    <div class="button-container">
      <button class="button" onclick="generateLine('spicy')">Spicy ğŸ”¥</button>
      <button class="button safe" onclick="generateLine('soft')">Soft ğŸŒ</button>
      <button class="button romantic" onclick="generateLine('romantic')">Romantic ğŸ’•</button>
    </div>
    <div class="button-container">
      <button class="button copy" onclick="copyToClipboard()">Copy Message ğŸ“‹</button>
      <button class="button favorite" onclick="addToFavorites()">Add to Favorites â¤ï¸</button>
      <button class="button" onclick="toggleFavorites()">Show Favorites ğŸ“œ</button>
      <button class="button copy" onclick="shareMessage()">Share via WhatsApp ğŸ’¬</button>
    </div>
    <div id="favoritesPanel" class="favorites-panel">
      <h3>Your Favorite Lines</h3>
      <ul id="favoritesList" class="favorites-list"></ul>
      <div class="export-import">
        <button class="button copy" onclick="exportFavorites()">Export â¬‡ï¸</button>
      </div>
      <div id="storageInfo"></div>
    </div>
    <div class="footer">
      <p>Made with â¤ï¸ | Share with someone special</p>
      <p class="privacy-note">Your favorites are stored only on your device. No data is sent to servers.</p>
    </div>
  </div>
  <script>
   let currentCategory = '';
   let currentMessage = '';
   let lastMessage = '';
   let isDarkMode = false;
   let favorites = [];
   
   let storageAvailable = false;
   try {
     localStorage.setItem('test', 'test');
     localStorage.removeItem('test');
     storageAvailable = true;
     favorites = JSON.parse(localStorage.getItem('favorites')) || [];
   } catch (e) {
     console.error('localStorage not available:', e);
   }
   
    const spicyLines = [
  "â€¦you wouldn't be walking straight for days.",
  "â€¦I'd make you coffee naked â€” and you wouldn't get to drink it â˜•."
];
   
  const softLines = [
  "â€¦you wouldn't be walking straight for days.",
  "â€¦I'd make you tea naked â€” and you wouldn't get to drink it â˜•.",
  "â€¦weâ€™d fog up every mirror in this place.",
  "â€¦I'd pin you against the fridge mid-snack raid.",
  "â€¦the duvet wouldnâ€™t survive the night.",
  "â€¦youâ€™d be too sore to sit through a Zoom call ğŸ’».",
  "â€¦I'd whisper the filthiest things in my poshest voice.",
  "â€¦youâ€™d need a safe word â€” and a backup.",
  "â€¦weâ€™d steam up the shower â€” then forget to wash.",
  "â€¦youâ€™d make that sound I like. Over. And over. ğŸ˜ˆ",
  "â€¦the neighbours would either complain or applaud.",
  "â€¦I'd show you why hotel towels are never enough.",
  "â€¦youâ€™d say my name like a prayer. Or a warning.",
  "â€¦weâ€™d mess up the sofa cushions beyond recovery.",
  "â€¦Iâ€™d make your thighs shake like dodgy Wi-Fi.",
  "â€¦you wouldnâ€™t want to leave the bed â€” ever again.",
  "â€¦weâ€™d turn a lazy Sunday into pure chaos.",
  "â€¦I'd tease you just enough to ruin your daydreams.",
  "â€¦youâ€™d bite your lip. I'd pull it free. ğŸ¥µ",
  "â€¦weâ€™d need a whole bottle of water on the nightstand.",
  "â€¦youâ€™d be out of breath before your clothes were off.",
  "â€¦Iâ€™d leave fingerprints on places you canâ€™t show.",
  "â€¦your knickers wouldnâ€™t stand a chance.",
  "â€¦I'd press you into the wall like youâ€™re wallpaper.",
  "â€¦Iâ€™d tug your hair and grin when you moan.",
  "â€¦weâ€™d break the bed. And then blame IKEA.",
  "â€¦I'd ruin your lipstick. Thoroughly ğŸ’„.",
  "â€¦we'd create a new kind of cardio.",
  "â€¦I'd make you late. Repeatedly.",
  "â€¦Iâ€™d mutter filth into your ear until your knees gave in.",
  "â€¦youâ€™d beg for one more round â€” then another.",
  "â€¦I'd kiss every inch of you, starting with your grin.",
  "â€¦you wouldnâ€™t need Netflix â€” or chill.",
  "â€¦your legs would forget how to function.",
  "â€¦I'd pin your wrists and ask if you're sure. Twice.",
  "â€¦youâ€™d forget your name â€” and scream mine.",
  "â€¦I'd make your knees jealous of the floor.",
  "â€¦youâ€™d wake up sore and smug.",
  "â€¦Iâ€™d remind you how good impatience can feel.",
  "â€¦youâ€™d leave with scratches you canâ€™t explain.",
  "â€¦I'd use your pulse as my metronome.",
  "â€¦Iâ€™d kiss you like Iâ€™m starving.",
  "â€¦weâ€™d end up tangled and smug in a pile of sheets.",
  "â€¦I'd say something filthy â€” and then do it.",
  "â€¦youâ€™d need a bath. And then another round in it.",
  "â€¦Iâ€™d take my time. Then speed up. Then ruin you.",
  "â€¦your clothes would be gone before you noticed.",
  "â€¦I'd worship your body like a sinner at church.",
  "â€¦youâ€™d need plasters for reasons you wonâ€™t tell your mum.",
  "â€¦Iâ€™d leave you grinning at every flashback.",
  "â€¦weâ€™d forget the takeaway on the doorstep.",
  "â€¦I'd kiss you so slowly you'd forget how clocks work.",
  "â€¦your voice would go hoarse â€” and Iâ€™d love it.",
  "â€¦I'd push you against the window and hope it rains.",
  "â€¦I'd undo you with just a look ğŸ˜.",
  "â€¦youâ€™d swear this was illegal. And want more.",
  "â€¦Iâ€™d whisper things that wouldnâ€™t survive a group chat.",
  "â€¦your hips would have stories they canâ€™t share.",
  "â€¦weâ€™d break every 'no touching' rule ever made.",
  "â€¦I'd pull your shirt over your head like a magician.",
  "â€¦youâ€™d feel me for hours after Iâ€™m gone.",
  "â€¦Iâ€™d wake you up like an alarm you want to snooze ğŸ”¥.",
  "â€¦weâ€™d have to air the room out.",
  "â€¦Iâ€™d let you try to top me â€” for a while.",
  "â€¦youâ€™d call me trouble. Then ask for more.",
  "â€¦I'd make you spill your drink. On purpose ğŸ·.",
  "â€¦your bedframe would file a noise complaint.",
  "â€¦I'd tease you in public â€” and finish the sentence at home.",
  "â€¦youâ€™d call in sick, and it wouldnâ€™t be a lie.",
  "â€¦I'd leave your heart racing and your back arched.",
  "â€¦youâ€™d forget what modesty even means.",
  "â€¦I'd make your thighs the star of the evening.",
  "â€¦youâ€™d need a lie-down and a cup of tea.",
  "â€¦Iâ€™d talk you into it â€” then out of your clothes.",
  "â€¦weâ€™d turn soft sheets into a crime scene.",
  "â€¦youâ€™d ask me to behave â€” but not mean it.",
  "â€¦I'd turn your moan into my victory chant.",
  "â€¦weâ€™d set a new decibel record.",
  "â€¦youâ€™d run out of excuses for the marks on your neck.",
  "â€¦I'd show you what that look earns you.",
  "â€¦youâ€™d blush remembering what I said â€” and did.",
  "â€¦I'd leave you gasping like you ran a marathon.",
  "â€¦youâ€™d ask for round two mid-round one.",
  "â€¦I'd slide your knickers aside like a bookmark.",
  "â€¦weâ€™d make your mattress proud.",
  "â€¦youâ€™d be unable to focus for days.",
  "â€¦I'd say 'just one kiss' â€” and lie.",
  "â€¦youâ€™d try to be quiet. And fail. Gloriously.",
  "â€¦weâ€™d both need a cold shower â€” after the third round.",
  "â€¦I'd let my hands do the talking.",
  "â€¦youâ€™d arch so pretty Iâ€™d lose my patience.",
  "â€¦Iâ€™d earn every whimper, one at a time.",
  "â€¦your neighbours would write us hate mail â€” or ask to join.",
  "â€¦Iâ€™d call you â€˜darlingâ€™ while ruining you.",
  "â€¦youâ€™d need a stretch and a smug grin after.",
  "â€¦I'd edge you just to hear that whimper again.",
  "â€¦weâ€™d run out of clean sheets and not care.",
  "â€¦youâ€™d remember it every time you sat down.",
  "â€¦I'd leave your lipstick on my inner thighs.",
  "â€¦youâ€™d swear I was reading your mind.",
  "â€¦I'd take you apart like a favourite song â€” slow, then loud.",
  "â€¦youâ€™d rethink every past lover â€” and smile.",
  "â€¦I'd tell you exactly what I want. And take it.",
  "â€¦youâ€™d gasp, curse, and beg in one breath.",
  "â€¦weâ€™d test how loud is too loud. Then go louder.",
  "â€¦Iâ€™d earn a five-star rating â€” no notes.",
  "â€¦youâ€™d need new knickers. Again."
];
   
  const romanticLines = [
  "â€¦I'd hold you close and count your heartbeats.",
  "â€¦I'd trace constellations on your skin.",
  "â€¦we'd slow dance in the kitchen at 2am.",
  "â€¦I'd write love poems on your back with my fingertips.",
  "â€¦I'd memorise every freckle on your face.",
  "â€¦we'd watch the sunrise wrapped in one blanket.",
  "â€¦I'd play with your hair until you fell asleep.",
  "â€¦I'd tell you all the ways you've changed my world.",
  "â€¦we'd make plans for forever between kisses.",
  "â€¦I'd show you how time can stand still.",
  "â€¦I'd remind you how perfect you are to me.",
  "â€¦we'd create memories to keep us warm on cold nights.",
  "â€¦I'd tell the stars about you ğŸŒŒ.",
  "â€¦weâ€™d kiss like weâ€™ve just found each other again.",
  "â€¦I'd write your name in the fog on the windowpane.",
  "â€¦weâ€™d say nothing, and still say everything.",
  "â€¦I'd love you like it's my full-time job.",
  "â€¦weâ€™d find poetry in the ordinary.",
  "â€¦I'd whisper I love you when youâ€™re already asleep.",
  "â€¦weâ€™d plan a future that tastes like home.",
  "â€¦I'd kiss your forehead every morning without fail.",
  "â€¦weâ€™d share headphones and a heartbeat ğŸ§.",
  "â€¦I'd get lost in your eyes and call it travelling.",
  "â€¦weâ€™d light candles for no reason at all ğŸ•¯ï¸.",
  "â€¦I'd steal kisses like secrets in a crowded room.",
  "â€¦weâ€™d take the long way home just to stay together.",
  "â€¦I'd keep a picture of your smile in my wallet.",
  "â€¦weâ€™d write each other love letters on rainy Sundays.",
  "â€¦I'd save the last piece of cake just for you ğŸ°.",
  "â€¦weâ€™d fall asleep mid-conversation, still smiling.",
  "â€¦I'd buy you flowers on a random Tuesday ğŸŒ¼.",
  "â€¦weâ€™d kiss under the streetlight like a film ending.",
  "â€¦I'd pour you tea just the way you like it â€” always.",
  "â€¦weâ€™d celebrate the little things like anniversaries.",
  "â€¦I'd look at you like youâ€™re the only person in the room.",
  "â€¦weâ€™d lie in bed and talk about everything and nothing.",
  "â€¦I'd learn your favourite song and hum it when you're sad.",
  "â€¦weâ€™d pretend the world pauses when we're together.",
  "â€¦I'd stay up just to hear how your day went.",
  "â€¦weâ€™d go stargazing and name them after each other.",
  "â€¦I'd fall in love with you like itâ€™s brand new, every day.",
  "â€¦weâ€™d take Polaroids and stick them to the fridge.",
  "â€¦I'd make space for you in every plan I have.",
  "â€¦weâ€™d go on bookshop dates and get lost in stories ğŸ“š.",
  "â€¦I'd wrap you in my coat when itâ€™s cold, always.",
  "â€¦weâ€™d sit in silence that feels like a song.",
  "â€¦I'd bring you coffee just for the smile it brings â˜•.",
  "â€¦weâ€™d walk hand in hand and never let go.",
  "â€¦I'd kiss your knuckles and mean it.",
  "â€¦weâ€™d nap together like itâ€™s our religion.",
  "â€¦I'd leave you notes in your bag just to say I care.",
  "â€¦weâ€™d dance at weddings like itâ€™s just us there.",
  "â€¦I'd be your calm when the world feels loud.",
  "â€¦weâ€™d match our steps without trying.",
  "â€¦I'd call you 'home' and mean every syllable.",
  "â€¦weâ€™d spend hours doing nothing â€” perfectly.",
  "â€¦I'd stroke your cheek like itâ€™s made of stardust.",
  "â€¦weâ€™d rewatch our favourite film until we know every line.",
  "â€¦I'd remember the small things, always.",
  "â€¦weâ€™d kiss in the rain and laugh about it.",
  "â€¦I'd write your name into every chapter of my life.",
  "â€¦weâ€™d get caught staring and not look away.",
  "â€¦I'd let you fall asleep on me even if my arm goes numb.",
  "â€¦weâ€™d travel just to get lost together.",
  "â€¦I'd choose you in every lifetime.",
  "â€¦weâ€™d take selfies where I only look at you.",
  "â€¦I'd celebrate the shape of your smile.",
  "â€¦weâ€™d press our foreheads together and breathe.",
  "â€¦I'd say 'I love you' like a daily ritual.",
  "â€¦weâ€™d watch sunsets and pretend theyâ€™re for us ğŸŒ‡.",
  "â€¦I'd stay up just to hear your sleepy voice.",
  "â€¦weâ€™d share jumpers and hearts.",
  "â€¦I'd kiss your shoulder when words arenâ€™t enough.",
  "â€¦weâ€™d make breakfast together and slow dance with toast.",
  "â€¦I'd remember the way you take your tea â€” perfectly British.",
  "â€¦weâ€™d go on long walks just to hold hands.",
  "â€¦I'd learn your quirks and adore every single one.",
  "â€¦weâ€™d snuggle on the sofa and forget the world.",
  "â€¦I'd whisper your name like itâ€™s the most sacred thing I know.",
  "â€¦weâ€™d explore cities with hands clasped tight.",
  "â€¦I'd trace love notes on your back in the morning.",
  "â€¦weâ€™d stay in bed till the sun gives up â˜€ï¸.",
  "â€¦I'd keep a spare toothbrush for you â€” and a drawer.",
  "â€¦weâ€™d kiss on the escalator like no oneâ€™s watching.",
  "â€¦I'd fold your clothes and kiss your collarbone.",
  "â€¦weâ€™d talk about the stars like old friends.",
  "â€¦I'd find ways to fall in love with you every single day.",
  "â€¦weâ€™d light fairy lights and share secrets.",
  "â€¦I'd rub your back when youâ€™re anxious and hold space.",
  "â€¦weâ€™d make anniversaries out of Tuesdays.",
  "â€¦I'd play your laugh on repeat in my memory.",
  "â€¦weâ€™d stand still on the bridge and just breathe.",
  "â€¦I'd save you the last bite, even when I donâ€™t want to.",
  "â€¦weâ€™d talk until the sky turns pink.",
  "â€¦I'd carry your favourite sweets in my coat pocket ğŸ¬.",
  "â€¦weâ€™d have inside jokes no one else gets.",
  "â€¦I'd catch you staring and smile every time.",
  "â€¦weâ€™d hold each other like itâ€™s the only thing that matters.",
  "â€¦I'd lean into you like youâ€™re the answer to everything.",
  "â€¦weâ€™d share silence that feels like a symphony.",
  "â€¦I'd send you songs that say what I canâ€™t.",
  "â€¦weâ€™d nap after Sunday roasts, fully content.",
  "â€¦I'd kiss your temple and wish time would stop.",
  "â€¦weâ€™d whisper under the duvet like kids again.",
  "â€¦I'd leave lipstick on your cheek on purpose ğŸ’‹.",
  "â€¦weâ€™d look at old photos and still feel butterflies.",
  "â€¦I'd wake you with kisses on grey mornings.",
  "â€¦weâ€™d hold pinkies and call it fate.",
  "â€¦I'd never stop writing stories with you in them."
  ];
   
   function generateLine(category) {
     let lines;
     let indicator;
   
     currentCategory = category;
   
     switch (category) {
       case 'spicy':
         lines = spicyLines;
         indicator = '<span class="indicator spicy-indicator"></span>';
         break;
       case 'soft':
         lines = softLines;
         indicator = '<span class="indicator soft-indicator"></span>';
         break;
       case 'romantic':
         lines = romanticLines;
         indicator = '<span class="indicator romantic-indicator"></span>';
         break;
       default:
         lines = spicyLines;
         indicator = '<span class="indicator spicy-indicator"></span>';
     }
   
     let line;
     do {
       line = lines[Math.floor(Math.random() * lines.length)];
     } while (line === lastMessage && lines.length > 1); // Prevent repeat
   
     lastMessage = line;
     currentMessage = line;
   
     const messageEl = document.getElementById("message");
     messageEl.innerHTML = indicator + line;
     messageEl.classList.remove("message-fade");
     void messageEl.offsetWidth;
     messageEl.classList.add("message-fade");
   }
   
   function copyToClipboard() {
     if (!currentMessage) return;
   
     navigator.clipboard.writeText("If I had you here" + currentMessage)
       .then(() => {
         showToast("Copied to clipboard!");
       })
       .catch(err => {
         console.error('Failed to copy: ', err);
         // Fallback for browsers that don't support clipboard API
         const textArea = document.createElement('textarea');
         textArea.value = "If I had you here" + currentMessage;
         textArea.style.position = 'fixed';
         textArea.style.left = '-999999px';
         document.body.appendChild(textArea);
         textArea.select();
         
         try {
           document.execCommand('copy');
           showToast("Copied to clipboard!");
         } catch (err) {
           showToast("Unable to copy. Try selecting and copying manually.");
         }
         
         document.body.removeChild(textArea);
       });
   }
   
   function showToast(text) {
     // Remove any existing toasts
     const existingToasts = document.querySelectorAll('.toast');
     existingToasts.forEach(toast => toast.remove());
     
     const toast = document.createElement('div');
     toast.textContent = text;
     toast.className = 'toast';
     document.body.appendChild(toast);
     
     setTimeout(() => { toast.style.opacity = '1'; }, 10);
     setTimeout(() => {
       toast.style.opacity = '0';
       setTimeout(() => toast.remove(), 300);
     }, 2000);
   }
   
   function addToFavorites() {
     if (!currentMessage || !storageAvailable) {
       if (!storageAvailable) {
         showToast("Storage not available in your browser");
       }
       return;
     }
   
     const newFavorite = {
       message: currentMessage,
       category: currentCategory,
       date: new Date().toLocaleDateString()
     };
   
     if (!favorites.some(fav => fav.message === currentMessage)) {
       favorites.push(newFavorite);
       saveFavorites();
       renderFavorites();
       showToast("Added to favorites!");
     } else {
       showToast("Already in favorites.");
     }
   }
   
   function saveFavorites() {
     if (storageAvailable) {
       try {
         localStorage.setItem('favorites', JSON.stringify(favorites));
         updateStorageInfo();
       } catch (e) {
         console.error('Error saving to localStorage:', e);
         showToast("Error saving favorites. Storage might be full.");
       }
     }
   }
   
   function removeFavorite(index) {
     favorites.splice(index, 1);
     saveFavorites();
     renderFavorites();
   }
   
   function renderFavorites() {
     const favoritesList = document.getElementById("favoritesList");
     favoritesList.innerHTML = '';
   
     if (favorites.length === 0) {
       favoritesList.innerHTML = '<li>No favorites yet! Add some you like.</li>';
       return;
     }
   
     favorites.forEach((fav, index) => {
       const li = document.createElement('li');
       let indicator;
       switch (fav.category) {
         case 'spicy':
           indicator = '<span class="indicator spicy-indicator"></span>';
           break;
         case 'soft':
           indicator = '<span class="indicator soft-indicator"></span>';
           break;
         case 'romantic':
           indicator = '<span class="indicator romantic-indicator"></span>';
           break;
         default:
           indicator = '';
       }
   
       li.innerHTML = `
         ${indicator} If I had you here${fav.message}
         <button onclick="removeFavorite(${index})">Ã—</button>
       `;
       favoritesList.appendChild(li);
     });
     
     updateStorageInfo();
   }
   
   function updateStorageInfo() {
     if (!storageAvailable) return;
     
     const storageInfo = document.getElementById('storageInfo');
     const favoritesSize = new Blob([JSON.stringify(favorites)]).size;
     const kbSize = (favoritesSize / 1024).toFixed(2);
     storageInfo.textContent = `Storage used: ${kbSize} KB`;
   }
   
   function toggleFavorites() {
     const favoritesPanel = document.getElementById("favoritesPanel");
     favoritesPanel.classList.toggle("active");
     renderFavorites();
   }
   
   function toggleTheme() {
     const body = document.body;
     const themeToggle = document.querySelector(".theme-toggle");
     isDarkMode = !isDarkMode;
   
     if (isDarkMode) {
       body.classList.add("dark-mode");
       themeToggle.textContent = "â˜€ï¸";
       if (storageAvailable) localStorage.setItem('darkMode', 'true');
     } else {
       body.classList.remove("dark-mode");
       themeToggle.textContent = "ğŸŒ™";
       if (storageAvailable) localStorage.setItem('darkMode', 'false');
     }
   }
   
   function shareMessage() {
     if (!currentMessage) return;
     const text = encodeURIComponent("If I had you here" + currentMessage);
     const url = `https://wa.me/?text=${text}`;
     window.open(url, '_blank');
   }
   
   function exportFavorites() {
     if (favorites.length === 0) {
       showToast("No favorites to export");
       return;
     }
     
     const dataStr = JSON.stringify(favorites, null, 2);
     const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
     
     const exportFileDefaultName = 'if-i-had-you-here-favorites.txt';
     
     const linkElement = document.createElement('a');
     linkElement.setAttribute('href', dataUri);
     linkElement.setAttribute('download', exportFileDefaultName);
     linkElement.click();
     
     showToast("Favorites exported successfully");
   }
   
   function importFavorites(files) {
     if (!files.length) return;
     
     const file = files[0];
     const reader = new FileReader();
     
     reader.onload = function(e) {
       try {
         const importedFavorites = JSON.parse(e.target.result);
         
         if (Array.isArray(importedFavorites)) {
           // Merge with existing favorites, avoiding duplicates
           importedFavorites.forEach(newFav => {
             if (!favorites.some(existingFav => existingFav.message === newFav.message)) {
               favorites.push(newFav);
             }
           });
           
           saveFavorites();
           renderFavorites();
           showToast(`Imported ${importedFavorites.length} favorites`);
         } else {
           showToast("Invalid favorites file format");
         }
       } catch (e) {
         console.error('Error importing favorites:', e);
         showToast("Error importing favorites file");
       }
     };
     
     reader.readAsText(file);
     document.getElementById('importInput').value = '';
   }
   
   // Load dark mode preference
   function loadSettings() {
     if (storageAvailable) {
       // Load dark mode
       if (localStorage.getItem('darkMode') === 'true') {
         isDarkMode = true;
         document.body.classList.add("dark-mode");
         document.querySelector(".theme-toggle").textContent = "â˜€ï¸";
       }
     }
   }
   
   window.addEventListener('load', () => {
     loadSettings();
     const categories = ['spicy', 'soft', 'romantic'];
     const randomCat = categories[Math.floor(Math.random() * categories.length)];
     generateLine(randomCat);
     renderFavorites();
   });
  </script>
</body>
</html>